<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!--        <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png">-->

        <title>Protein Tertiary Matching</title>

        <!-- Bootstrap core CSS -->
        <link href="css/bootstrap.css" rel="stylesheet">
        <link href="css/bootstrap-theme.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <!-- Just for debugging purposes. Don't actually copy this line! -->
        <!--[if lt IE 9]><script src="../../docs-assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <button data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar" type="button">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="#" class="brand">COMOGRAD</a>
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li class="active"><a href="#">Home</a></li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#contact">Contact</a></li>
                            <li class="dropdown">
                                <a data-toggle="dropdown" class="dropdown-toggle" href="#">Dropdown here <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="#">Action</a></li>
                                    <li><a href="#">Another action</a></li>
                                    <li><a href="#">Something else here</a></li>
                                    <li class="divider"></li>
                                    <li class="nav-header">Nav header</li>
                                    <li><a href="#">Separated link</a></li>
                                    <li><a href="#">One more separated link</a></li>
                                </ul>
                            </li>
                        </ul>
                        <form class="navbar-form pull-right">
                            <input type="text" placeholder="Email" class="span2">
                            <input type="password" placeholder="Password" class="span2">
                            <button class="btn" type="submit">Sign in</button>
                        </form>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>
        <div class="hero-unit">
            <div class="offset2">

                <h3>Enter ScopID</h3>
                <div id="chatLog">

                </div><!-- #chatLog -->
                <p id="examples">Press enter after the scopID(eg d16vpa_)</p>
                <input class="input-xlarge form-control" id ="text" type="text"  name="search_text">
                <!--                <input id="text" type="text" />-->
                <button id="disconnect" class="btn btn-primary" type="button">Disconnect</button>


            </div>
        </div>
        <!-- /container -->

        <div id="output"></div>

        <script type="text/javascript" src="websocket.js"></script>
        <!--        <script type="text/javascript" src="whiteboard.js"></script>-->
        <!--        <script type="text/javascript" src="js/bootstrap.min.js"></script>-->
        <script>
            var flg = 2;//default recieved
            function connect() {
                var socket;
                console.log(document.location.pathname);
                var host = "ws://" + document.location.host + document.location.pathname + "whiteboardendpoint";

                try {
                    var socket = new WebSocket(host);

                    message('<p class="event">Socket Status: ' + socket.readyState);

                    socket.onopen = function() {
                        message('<p class="event">Socket Status: ' + socket.readyState + ' (open)');
                    }

                    socket.onmessage = function(msg) {
                        if (msg.data = "result")
                            flg = 0;
                        else if (msg.data = "log")
                            flg = 1;
                        else {
                            if (flg == 0)
                                message('<p class="result"> ' + msg.data);
                            else if (flg == 1)
                                message('<p class="log">log ' + msg.data);
                            else
                                message('<p class="message">Received: ' + msg.data);
                        }
                    }

                    socket.onclose = function() {
                        message('<p class="event">Socket Status: ' + socket.readyState + ' (Closed)');
                    }

                } catch (exception) {
                    message('<p>Error' + exception);
                }

                function send() {
                    var text = $('#text').val();

                    if (text == "") {
                        message('<p class="warning">Please enter a message');
                        return;
                    }
                    try {
                        socket.send(text);

                        message('<p class="event">Sent: ' + text)

                    } catch (exception) {
                        message('<p class="warning">');
                    }
                    $('#text').val("");
                }

                function message(msg) {
                    $('#chatLog').append(msg + '</p>');
                }

                $('#text').keypress(function(event) {
                    if (event.keyCode == '13') {
                        send();
                    }
                });

                $('#disconnect').click(function() {
                    socket.close();
                });

            }//End connect
            $(document).ready(function() {

                if (!("WebSocket" in window)) {
                    $('#chatLog, input, button, #examples').fadeOut("fast");
                    $('<p>Oh no, you need a browser that supports WebSockets. How about <a href="http://www.google.com/chrome">Google Chrome</a>?</p>').appendTo('#container');
                } else {
                    //The user has WebSockets

                    connect();



                }//End else

            });
        </script>
    </body>
</html>
